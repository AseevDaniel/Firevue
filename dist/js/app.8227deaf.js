(function(e){function t(t){for(var n,o,i=t[0],u=t[1],l=t[2],d=0,m=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);c&&c(t);while(m.length)m.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,i=1;i<r.length;i++){var u=r[i];0!==s[u]&&(n=!1)}n&&(a.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},s={app:0},a=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var c=u;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0e76":function(e,t,r){},"22c4":function(e,t,r){"use strict";var n=r("a224"),s=r.n(n);s.a},"35b9":function(e,t,r){"use strict";var n=r("636b"),s=r.n(n);s.a},4896:function(e,t,r){"use strict";var n=r("0e76"),s=r.n(n);s.a},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("transition",{attrs:{name:"slide-fade"}},[r("router-view")],1)],1)},a=[],o={name:"app",data:function(){return{}},mounted:function(){},computed:{},methods:{}},i=o,u=(r("22c4"),r("2877")),l=Object(u["a"])(i,s,a,!1,null,"52ac39ff",null),c=l.exports,d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"mainPage"}},[e.currnetUser?r("div",{staticClass:"chat"},[r("h2",{staticStyle:{"text-align":"center","margin-top":"0"}},[e._v("Space Whale CHAT")]),r("h2",[e._v("Online users: "),e._l(e.onlineUsers,(function(t,n){return r("p",{key:n,staticClass:"bold"},[e._v(" "+e._s(t.name+(e.onlineUsers[e.onlineUsers.length-1]==t?"":","))+" ")])}))],2),r("br"),r("h2",[e._v("Your name: "),r("router-link",{attrs:{to:{path:"/user/"+e.currnetUser+"/"+e.currnetEmail}}},[r("p",{staticClass:"bold"},[e._v(e._s(e.currnetUser))])])],1),r("button",{staticClass:"logout",attrs:{type:"button",name:"button"},on:{click:function(t){return e.logOut()}}},[e._v("Log out")]),r("hr"),r("div",[r("div",{staticClass:"messages"},[e._l(e.messages,(function(t,n){return r("article",{key:n,staticClass:"collectMess"},[r("h1",[r("p",{staticClass:"bold",class:{admin:"admin"==t.author},staticStyle:{cursor:"pointer"},on:{click:function(r){return e.emailLink(t.email)}}},[r("router-link",{style:{color:"admin"==t.author?"red":"#42b983"},attrs:{to:{path:"/user/"+t.author+"/"+t.email}}},[e._v(e._s(t.author))])],1),e._v(": "),t.message?r("p",{staticStyle:{display:"inline"}},[e._v(e._s(t.message))]):e._e(),e._v(" "),t.img?r("img",{attrs:{src:t.img,alt:""}}):e._e(),e.isYourMessage(t.author)||"admin"==e.currnetUser?r("button",{staticClass:"del",on:{click:function(r){return e.deleteMes(t.id,t.author)}}},[e._v("×")]):e._e()])])})),r("h2",[e._v("Enter your message: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.yourMessage,expression:"yourMessage"}],staticClass:"inputMessage",staticStyle:{display:"inline"},attrs:{type:"text",name:"",value:""},domProps:{value:e.yourMessage},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterMessage()},input:function(t){t.target.composing||(e.yourMessage=t.target.value)}}}),r("button",{staticClass:"file",staticStyle:{display:"inline"},attrs:{type:"button"}},[e._v("🔍"),r("input",{ref:"myFiles",attrs:{id:"file",accept:"image/*",type:"file",name:"",value:""},on:{change:function(t){return e.sendImg()}}})])])],2)])]):e._e(),e.currnetUser?e._e():r("div",{staticClass:"auth"},[r("div",{},[e.signUp?e._e():r("div",{staticClass:"enterName"},[r("h1",{staticStyle:{"text-align":"center"}},[e._v("Sign in")]),r("div",{staticClass:"regOrLog"},[r("h2",[e._v("Enter your email: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],staticStyle:{display:"inline"},attrs:{type:"text",name:"",value:""},domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}})]),r("h2",[e._v("Enter your password: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.userPassword,expression:"userPassword"}],staticStyle:{display:"inline"},attrs:{type:"password",name:"",value:""},domProps:{value:e.userPassword},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enter()},input:function(t){t.target.composing||(e.userPassword=t.target.value)}}})])]),r("p",{staticClass:"error",attrs:{v:"error"}},[e._v(e._s(e.error))]),r("button",{on:{click:function(t){return e.enter()}}},[e._v("Log in")]),r("a",{on:{click:function(t){e.signUp=!0,e.error=""}}},[r("h3",[e._v("Or sign up")])])]),e.signUp?r("div",{staticClass:"enterName"},[r("h1",{staticStyle:{"text-align":"center"}},[e._v("Sign up")]),r("div",{staticClass:"regOrLog"},[r("h2",[e._v("Enter email: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newUserEmail,expression:"newUserEmail"}],staticStyle:{display:"inline"},attrs:{type:"email",name:"",value:""},domProps:{value:e.newUserEmail},on:{input:function(t){t.target.composing||(e.newUserEmail=t.target.value)}}})]),r("h2",[e._v("Enter name: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newUserName,expression:"newUserName"}],staticStyle:{display:"inline"},attrs:{type:"text",name:"",value:""},domProps:{value:e.newUserName},on:{input:function(t){t.target.composing||(e.newUserName=t.target.value)}}})]),r("h2",[e._v("Enter password: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newUserPassword,expression:"newUserPassword"}],staticStyle:{display:"inline"},attrs:{type:"password",name:"",value:""},domProps:{value:e.newUserPassword},on:{input:function(t){t.target.composing||(e.newUserPassword=t.target.value)}}})]),r("h2",[e._v("Repeat password: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.repeatUserPassword,expression:"repeatUserPassword"}],staticStyle:{display:"inline"},attrs:{type:"password",name:"",value:""},domProps:{value:e.repeatUserPassword},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createUser()},input:function(t){t.target.composing||(e.repeatUserPassword=t.target.value)}}})])]),r("p",{staticClass:"error",attrs:{v:"error"}},[e._v(e._s(e.error))]),r("button",{on:{click:function(t){return e.createUser()}}},[e._v("Sign up")]),r("a",{on:{click:function(t){e.signUp=!1,e.error=""}}},[r("h3",[e._v("Or sign in")])])]):e._e()])])])},m=[],p=(r("b0c0"),r("d3b7"),r("07ac"),r("3ca3"),r("498a"),r("ddb0"),r("96cf"),r("1da1")),f={name:"mainPage",data:function(){return{products:{},messages:{},users:{},onlineUsers:{},db:this.$firebase.firestore(),storage:this.$firebase.storage(),userName:"",userEmail:"",userPassword:"",newUserName:"",newUserEmail:"",newUserPassword:"",repeatUserPassword:"",yourMessage:"",signUp:!1,name:"",nameDelete:"",url:"",test:"asdsads",cost:0,createNew:!1,deleteNew:!1,basket:[],showBasket:!1,showProducts:!1,error:"",enteredImg:!1,img:"",srcImage:"",uid:"",onlineId:1}},firestore:function(){return{products:this.db.collection("products").orderBy("name"),messages:this.db.collection("messages").orderBy("date"),users:this.db.collection("users").orderBy("login"),onlineUsers:this.db.collection("onlineUsers").orderBy("name")}},mounted:function(){console.log("Current user: "+this.currnetUser),console.log("Current email: "+this.currnetEmail),console.log(this.onlineUsers)},computed:{currnetUser:function(){return this.$store.state.user},currnetEmail:function(){return this.$store.state.email}},methods:{createUser:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var r,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.newUserName.trim(),e.newUserEmail.trim(),e.newUserPassword.trim(),e.newUserPassword.trim(),r=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,n=r.test(String(e.newUserEmail).toLowerCase()),!(e.newUserPassword&&e.newUserName&&e.newUserEmail)){t.next=41;break}if(!n){t.next=38;break}if(e.newUserPassword!=e.repeatUserPassword){t.next=35;break}if(!(e.newUserPassword.length>5)){t.next=32;break}s=0;case 11:if(!(s<Object.values(e.users).length)){t.next=19;break}if(Object.values(e.users)[s].login!=e.newUserName){t.next=16;break}if(Object.values(e.users)[s].email!=e.newUserEmail){t.next=16;break}return e.error="this name/email is not available",t.abrupt("return");case 16:s++,t.next=11;break;case 19:return t.next=21,e.$firebase.auth().createUserWithEmailAndPassword(e.newUserEmail,e.newUserPassword).then((function(){console.log("good")})).catch((function(e){console.log(e)}));case 21:return t.next=23,e.db.collection("users").add({login:e.newUserName,email:e.newUserEmail,password:e.newUserPassword}).then((function(){console.log("Document successfully written!"),e.changeUser(e.newUserName),e.changeEmail(e.newUserEmail),e.onlineAdd(e.newUserName)})).catch((function(e){console.error("Error writing document: ",e)}));case 23:e.newUserName="",e.newUserEmail="",e.newUserPassword="",e.repeatUserPassword="",e.error="",console.log(e.$store.state.user),console.log(e.$store.state.email),t.next=33;break;case 32:e.error="Password must include more than 6 symbols";case 33:t.next=36;break;case 35:e.error="Password do not match";case 36:t.next=39;break;case 38:e.error="Email is not valid";case 39:t.next=42;break;case 41:e.error="All fields is required";case 42:case"end":return t.stop()}}),t)})))()},enter:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.userEmail.trim(),e.userPassword.trim(),r=regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Object.values(e.users)[r].email!=e.userEmail){t.next=5;break}if(Object.values(e.users)[r].password!=e.userPassword){t.next=5;break}return e.userName=Object.values(e.users)[r].login,t.next=5,e.$firebase.auth().signInWithEmailAndPassword(e.userEmail,e.userPassword).then((function(){console.log("good"),e.changeUser(Object.values(e.users)[r].login),e.changeEmail(e.userEmail),e.onlineAdd(Object.values(e.users)[r].login),console.log(e.userName),e.userName="",e.userEmail="",e.error="",e.userPassword="",console.log(e.$store.state.user),console.log(e.$store.state.email)})).catch((function(e){console.log(e)}));case 5:case"end":return t.stop()}}),t)})),n=0;case 4:if(!(n<Object.values(e.users).length)){t.next=9;break}return t.delegateYield(r(n),"t0",6);case 6:n++,t.next=4;break;case 9:e.error="wrong login or password";case 10:case"end":return t.stop()}}),t)})))()},changeUser:function(e){this.$store.commit("changeUser",e)},changeEmail:function(e){this.$store.commit("changeEmail",e)},getUserUid:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.currnetUser){t.next=5;break}return r=e,t.next=4,e.$firebase.auth().onAuthStateChanged((function(e){r.uid=e.uid,console.log(e.uid)}));case 4:console.log(r.uid);case 5:case"end":return t.stop()}}),t)})))()},userInfo:function(){this.$firebase.auth().onAuthStateChanged((function(e){e.displayName,e.email,e.emailVerified,e.photoURL,e.isAnonymous,e.uid,e.providerData;console.log(e.uid)}))},logOut:function(){this.onlineDel(this.currnetUser),this.error="",this.changeUser(""),this.changeEmail("")},enterMessage:function(){var e=this;this.$firebase.auth().onAuthStateChanged((function(t){var r=e.$store.state.user,n=e.$store.state.email,s=e.yourMessage,a=new Date;e.yourMessage&&(e.db.collection("messages").add({date:a,author:r,message:s,email:n}).then((function(){console.log("Message successfully send!")})).catch((function(e){console.error("Error writing document: ",e)})),e.yourMessage="",e.srcImage="")}))},sendImg:function(){var e=this;this.yourMessage="";var t=this.$refs.myFiles;if(t.files&&t.files[0]){var r=new FileReader,n=new Promise((function(e,t){r.onload=function(t){this.srcImage=t.target.result,e(this.srcImage)}}));n.then((function(t){var r=e.$store.state.user,n=e.$store.state.email,s=new Date;e.db.collection("messages").add({date:s,author:r,img:t,email:n}).then((function(){console.log("Img successfully send!")})).catch((function(e){console.error("Error writing document: ",e)}))})),r.readAsDataURL(t.files[0])}},isYourMessage:function(e){return e==this.$store.state.user},deleteMes:function(e){this.db.collection("messages").doc(e).delete().then((function(){console.log("Online successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}))},onlineAdd:function(e){console.log("its method onlineAdd");for(var t=0;t<this.onlineUsers.length;t++)if(this.onlineUsers[t].name=e)return;this.db.collection("onlineUsers").add({name:e}).then((function(){console.log("Online successfully add!")})).catch((function(e){console.error("Error writing document: ",e)}))},onlineDel:function(e){var t=this;console.log(Object.values(this.onlineUsers));for(var r=0;r<this.onlineUsers.length;r++)console.log(this.onlineUsers[r].name),console.log(this.onlineUsers[r].id),this.onlineUsers[r].name==e&&(this.onlineUsers[r].id,this.db.collection("onlineUsers").doc(this.onlineUsers[r].id).delete().then((function(){console.log(Object.values(t.onlineUsers)),console.log("Document successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})))}}},g=f,h=(r("4896"),Object(u["a"])(g,d,m,!1,null,"2e3ffb0c",null)),v=h.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"all"},[r("router-link",{attrs:{to:"/"}},[r("button",{staticStyle:{float:"right"},attrs:{type:"button",name:"button"}},[e._v("Back")])]),r("h1",[e._v("PROFILE")]),r("div",{staticClass:"info"},[r("p",[r("span",{staticStyle:{"font-weight":"bold"}},[e._v("User name:")]),e._v(" "+e._s(e.$route.params.name)+" "),r("br"),r("span",{staticStyle:{"font-weight":"bold"}},[e._v("User email:")]),e._v(" "+e._s(e.$route.params.email)+" ")]),r("button",{staticClass:"emailLink",attrs:{type:"button",name:"button"},on:{click:function(t){return e.emailLink(e.$route.params.email)}}},[e._v("Send mail")])])],1)},b=[],y={name:"user",data:function(){return{}},mounted:function(){},computed:{curEmail:function(){return this.email}},methods:{emailLink:function(e){location.href="mailto:"+e}}},U=y,_=(r("35b9"),Object(u["a"])(U,w,b,!1,null,"6c7df406",null)),k=_.exports,E=r("8aa5"),x=r.n(E),P=(r("e71f"),r("0ff2")),O=r("0e44"),S=r("a78e"),C=r("2f62"),$=r("bc3a"),N=r.n($),j=r("8c4f");r("000b"),r("ea7b");n["a"].use(j["a"]),window.axios=r("bc3a"),n["a"].prototype.$http=window.axios,n["a"].use(C["a"]),n["a"].use(P["a"]),x.a.initializeApp({projectId:"firevue0864",databaseURL:"https://firevue0864.firebaseio.com",apiKey:"AIzaSyDqSpw6l_n_hCi7lqfVTMSauKM1YhkZ6ig",authDomain:"firevue0864.firebaseapp.com",storageBucket:"firevue0864.appspot.com",messagingSenderId:"85280099974",appId:"1:85280099974:web:6d2cc9279d44a02eb34b07",measurementId:"G-81K3ESV0BD"});var M=[{path:"/",component:v,props:!0},{path:"/",component:c,props:!0},{path:"/user/:name/:email",component:k,props:!0}],A=new j["a"]({routes:M});n["a"].prototype.$firebase=x.a,n["a"].config.productionTip=!1;var I=new C["a"].Store({state:{user:"",email:""},mutations:{changeUser:function(e,t){e.user=t},changeEmail:function(e,t){e.email=t}},plugins:[Object(O["a"])({getStateUser:function(e){return S["getJSON"](e)},setStateUser:function(e,t){return S["set"](e,t,{})},getStateEmail:function(e){return S["getJSON"](e)},setStateEmail:function(e,t){return S["set"](e,t,{})}})]});new n["a"]({router:A,store:I,axios:N.a,render:function(e){return e(c)}}).$mount("#app")},"636b":function(e,t,r){},a224:function(e,t,r){}});
//# sourceMappingURL=app.8227deaf.js.map